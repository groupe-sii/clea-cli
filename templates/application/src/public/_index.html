<!doctype html>
<html ng-app="<%= slugifiedName %>" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title><%= appName %></title>
    <base href="/" />

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="favicon.ico" />

    <!-- Disable tap highlight on IE -->
    <meta name="msapplication-tap-highlight" content="no" />
    <% if (pwa) { %>
    <!-- Web Application Manifest -->
    <link rel="manifest" href="manifest.json" />

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="#2F3BA2" />
    <meta name="apple-mobile-web-app-title" content="Make it Progressive" />
    <link rel="apple-touch-icon" href="assets/icons/icon-128x128.png" />

    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="assets/icons/icon-128x128.png" />
    <meta name="msapplication-TileColor" content="#2F3BA2" /><% } %>
  </head>

  <body>
    <ui-view></ui-view><% if (pwa) { %>
    <script type="text/javascript">
      var isLocalhost = Boolean(window.location.hostname === 'localhost' ||
        // [::1] is the IPv6 localhost address.
        window.location.hostname === '[::1]' ||
        // 127.0.0.1/8 is considered localhost for IPv4.
        window.location.hostname.match(
          /^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/
        )
      );

      if ('serviceWorker' in navigator && (window.location.protocol === 'https:' || isLocalhost)) {
        navigator.serviceWorker.register('service-worker.js')
          .then(function(registration) {
            // updatefound is fired if service-worker.js changes.
            registration.onupdatefound = function() {
              // updatefound is also fired the very first time the SW is installed,
              // and there's no need to prompt for a reload at that point.
              // So check here to see if the page is already controlled,
              // i.e. whether there's an existing service worker.
              if (navigator.serviceWorker.controller) {
                // The updatefound event implies that registration.installing is set:
                // https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-container-updatefound-event
                var installingWorker = registration.installing;

                installingWorker.onstatechange = function() {
                  switch (installingWorker.state) {
                    case 'installed':
                      // At this point, the old content will have been purged and the
                      // fresh content will have been added to the cache.
                      // It's the perfect time to display a "New content is
                      // available; please refresh." message in the page's interface.
                      break;

                    case 'redundant':
                      throw new Error('The installing service worker became redundant.');

                    default:
                    // Ignore
                  }
                };
              }
            };
          }).catch(function(e) {
          console.error('Error during service worker registration:', e);
        });
      }
    </script><% } %>
  </body>
</html>
